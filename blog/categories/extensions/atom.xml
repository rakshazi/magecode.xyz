<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Extensions | MageCode]]></title>
  <link href="http://magecode.xyz/blog/categories/extensions/atom.xml" rel="self"/>
  <link href="http://magecode.xyz/"/>
  <updated>2015-08-17T17:41:56-04:00</updated>
  <id>http://magecode.xyz/</id>
  <author>
    <name><![CDATA[.h]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Webshopapps/Matrixrate Free Shipping Based on Price Incl. Tax]]></title>
    <link href="http://magecode.xyz/blog/webshopapps-matrixrate-free-shipping-based-on-price-incl-tax"/>
    <updated>2015-08-09T10:25:39-04:00</updated>
    <id>http://magecode.xyz/blog/webshopapps-matrixrate-free-shipping-based-on-price-incl-tax</id>
    <content type="html"><![CDATA[<h1>What is it?</h1>

<p>Magento module Webshopapps/Matrixrate allows you to give customer free shipping option if order totals will cost more than some money.</p>

<h1>Problem</h1>

<p>This module calculates only products price without included tax.</p>

<p>Imagine:</p>

<p>You have a store. You have product with base (real) price $8, but with tax (eg: $3) it will cost $11. You set in store settings that on the frontend part for customers must be displayed only price with included tax ($11). And you set in Webshopapps/Matrixrate config that free shipping option must be shown for order amount > $100.</p>

<p>Customer buys 10 products by $11 each, but module will calculate only base (real) price - $8 for each product. In that way, customer will see order total amount as $110 but he will have no free shipping option.</p>

<!--more-->


<h1>Solution</h1>

<p>Open your store root dir and then go to the Webshopapps/Matrixrate dir (usually, <code>app/code/community/Webshopapps/Matrixrate</code>). Now open file <code>Model/Carrier/Matrixrate.php</code> and find function <code>collectRates</code> in it (<em>public function collectRates(Mage_Shipping_Model_Rate_Request $request)</em>).</p>

<p>Add following code before <code>//Free shipping by qty</code>:
<code>php
foreach ($request-&gt;getAllItems() as $item) {
    $request-&gt;setPackageValue($request-&gt;getPackageValue() + $item-&gt;getTaxAmount());
}
</code></p>

<p>That&rsquo;s all!</p>
]]></content>
  </entry>
  
</feed>
